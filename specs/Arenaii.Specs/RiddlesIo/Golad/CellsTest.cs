using Arenaii.RiddlesIo.Golad.Data;
using Arenaii.RiddlesIo.Golad.Model;
using Arenaii.RiddlesIo.Golad.Moves;

namespace Arenaii.UnitTests.RiddlesIo.Golad;

public class CellsTest
{
    [TestCase(".,.,.,.,0,.,.,.,.,.,.,.,.,.,.,.,.,1,.,0,.,1,.,0,1,.,.,1,.,.,1,.,.,.,.,.,.,0,.,.,.,1,1,.,1,.,1,.,.,0,.,0,.,.,0,.,.,.,.,.,.,1,0,.,.,1,.,.,0,.,1,1,.,1,.,.,0,1,0,.,.,0,.,0,1,0,.,.,.,.,0,1,.,1,.,.,1,.,.,.,0,.,.,0,1,.,0,.,.,1,.,1,1,0,.,.,.,1,.,.,1,.,1,.,0,.,.,0,.,.,.,.,.,.,.,.,.,.,.,1,.,0,.,1,0,.,1,.,0,.,.,.,.,.,.,.,.,.,.,.,1,.,.,1,.,0,.,0,.,.,0,.,.,.,1,0,0,.,0,.,.,1,.,0,1,.,.,1,.,.,.,0,.,.,0,.,0,1,.,.,.,.,1,0,1,.,1,.,.,1,0,1,.,.,0,.,0,0,.,1,.,.,0,.,.,1,0,.,.,.,.,.,.,1,.,.,1,.,1,.,.,0,.,0,.,0,0,.,.,.,1,.,.,.,.,.,.,0,.,.,0,.,.,0,1,.,0,.,1,.,0,.,.,.,.,.,.,.,.,.,.,.,.,1,.,.,.,.")]
    [TestCase(".,.,.,1,.,1,.,.,.,.,.,0,.,0,1,1,.,1,.,.,1,1,.,.,.,.,.,0,1,.,1,.,.,.,0,.,0,.,.,.,1,.,0,.,1,.,0,.,.,.,.,1,.,.,.,.,1,.,0,.,1,.,0,.,0,.,0,.,.,.,1,.,0,.,.,.,1,.,1,.,0,0,.,0,.,1,.,1,.,.,.,.,0,0,.,.,.,.,.,.,.,0,1,.,.,1,.,.,.,.,.,.,.,.,.,.,0,.,.,1,.,.,1,.,.,1,.,.,.,.,.,.,1,1,0,.,.,1,1,.,1,.,1,.,.,0,.,0,.,0,0,.,.,1,0,0,.,.,.,.,.,.,0,.,.,0,.,.,0,.,.,1,.,.,.,.,.,.,.,.,.,.,0,.,.,0,1,.,.,.,.,.,.,.,1,1,.,.,.,.,0,.,0,.,1,.,1,1,.,0,.,0,.,.,.,1,.,0,.,.,.,1,.,1,.,1,.,0,.,1,.,0,.,.,.,.,0,.,.,.,.,1,.,0,.,1,.,0,.,.,.,1,.,1,.,.,.,0,.,0,1,.,.,.,.,.,0,0,.,.,0,.,0,0,1,.,1,.,.,.,.,.,0,.,0,.,.,.")]
    public void Parse_ToString(string input)
    {
        var cells = Cells.Parse(new GoladSettings(), input);
        cells.ToString().Should().Be(input);
    }

    [Test]
    public void Apply_SomeState()
    {
        var input = "   .,.,.,1,.,1,.,.,.,.,.,0,.,0,1,1,.,1,.,.,1,1,.,.,.,.,.,0,1,.,1,.,.,.,0,.,0,.,.,.,1,.,0,.,1,.,0,.,.,.,.,1,.,.,.,.,1,.,0,.,1,.,0,.,0,.,0,.,.,.,1,.,0,.,.,.,1,.,1,.,0,0,.,0,.,1,.,1,.,.,.,.,0,0,.,.,.,.,.,.,.,0,1,.,.,1,.,.,.,.,.,.,.,.,.,.,0,.,.,1,.,.,1,.,.,1,.,.,.,.,.,.,1,1,0,.,.,1,1,.,1,.,1,.,.,0,.,0,.,0,0,.,.,1,0,0,.,.,.,.,.,.,0,.,.,0,.,.,0,.,.,1,.,.,.,.,.,.,.,.,.,.,0,.,.,0,1,.,.,.,.,.,.,.,1,1,.,.,.,.,0,.,0,.,1,.,1,1,.,0,.,0,.,.,.,1,.,0,.,.,.,1,.,1,.,1,.,0,.,1,.,0,.,.,.,.,0,.,.,.,.,1,.,0,.,1,.,0,.,.,.,1,.,1,.,.,.,0,.,0,1,.,.,.,.,.,0,0,.,.,0,.,0,0,1,.,1,.,.,.,.,.,0,.,0,.,.,.";
        var expected = ".,.,1,.,1,.,.,.,.,0,0,.,.,.,1,1,.,.,.,.,.,.,.,1,.,.,.,.,.,.,.,.,.,.,0,.,.,1,.,.,1,.,.,1,1,.,0,.,1,.,.,.,.,1,0,.,.,.,0,.,.,.,0,.,0,0,.,.,.,.,.,.,.,0,0,.,1,1,.,.,.,.,.,0,.,.,.,.,.,.,.,.,0,0,.,.,.,0,.,.,.,.,1,1,.,.,1,.,.,.,.,.,.,.,0,.,.,.,1,1,.,.,.,.,1,.,.,.,.,.,0,0,1,0,0,.,1,.,1,1,1,1,.,.,.,.,0,0,0,0,.,0,.,1,1,0,1,1,.,.,.,.,.,0,.,.,.,.,0,0,.,.,.,1,.,.,.,.,.,.,0,.,.,.,0,0,.,.,.,.,1,.,.,.,1,1,.,.,0,.,.,.,.,.,1,.,.,.,.,.,0,0,.,1,1,.,.,.,.,.,.,.,1,1,.,1,.,.,.,1,.,.,.,1,1,.,.,.,.,0,.,1,.,0,0,.,.,0,.,.,0,.,.,.,.,.,.,.,.,.,.,.,.,.,0,.,.,.,.,.,.,0,0,0,.,.,.,1,1,.,.,.,.,0,.,0,.,.";

        var cells = Cells.Parse(new GoladSettings(), input);

        cells.Apply(Move.Pass);

        var move = new BirthMove(cells[0, 13], cells[16, 0], cells[16, 4]);

        cells.Apply(move).Should().BeTrue();
        cells.ToString().Should().Be(expected);
    }
}
